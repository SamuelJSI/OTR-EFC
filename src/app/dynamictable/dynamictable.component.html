<!-- notify Info -->
<div *ngIf="displayMsg" #alert class="alert alert-success alert-dismissible fade show" role="alert">
  <button type="button" class="close" aria-label="Close" (click)="closeAlert()">
    <span aria-hidden="true">&times;</span>
  </button>
  <strong>{{displayContent}}</strong>
</div>

<!-- Money code Create child component -->

<app-moneycode *ngIf="currentRoute !== '/dynamictable'" (buttonClicked)="parentEventHandlerFunction($event)">
</app-moneycode>

<h3 class="mctitle">Moneycode Activity List</h3><br>

<div class="container text-center" *ngIf="!showMCCreatePage && currentRoute !== '/createMoneycode'">

  <!-- bulk upload -->
<div class="actionRow">
  <mat-form-field style="width:20%;margin-right: 10px;margin-bottom: 50px;float:right">
    <mat-label *ngIf="selectedFile; else newFile">{{selectedFile.name}}</mat-label>
    <ng-template #newFile>
      <mat-label>Choose file</mat-label>
    </ng-template>
    <input matInput disabled>
    <button mat-fab color="primary" matSuffix (click)="fileInput.click()" class="uploadfile">
      <mat-icon>attach_file</mat-icon>Import
    </button>
    <input hidden (change)="fileupload($event)" #fileInput type="file" id="file" fxFlex="50">
  </mat-form-field>&nbsp;&nbsp;
  <div class="actionbuttons">

    <button mat-raised-button (click)="exporter.exportTable('csv')" color="primary">
      <mat-icon>download</mat-icon>Export
    </button>
    &nbsp;&nbsp;
    <button mat-raised-button (click)="openDialog('Add',{})" color="primary" data-placement="top" title="Add New MC">
      New Moneycode
    </button>&nbsp;&nbsp;
    <button mat-raised-button (click)="openDialog('DeleteAll',{});DeleteAll = true" color="primary" data-placement="top"
      title="DeleteAll">
      <mat-icon>delete</mat-icon>
    </button>
  </div>&nbsp;&nbsp;
  </div>
  <!-- Multiple Column filtering -->

  

  <!-- Data table -->

  <div class="table-responsive tablepostion example-container mat-elevation-z8 table-container">
    <table class="filterTable">
      <tbody>
        <tr>
          <td *ngFor="let col of columns;">
  
            <div [formGroup]="columnsGroup" *ngIf="col.name != 'select' && col.name != 'action'">
              <mat-form-field style="width:170px">
                <mat-label>{{col.name}}</mat-label>
                <input matInput formControlName="{{col.name}}" placeholder="search" autocomplete="off">
                <mat-placeholder>{{col.name}}</mat-placeholder>
              </mat-form-field>&nbsp;&nbsp;&nbsp;
            </div>
          </td>
        </tr>
      </tbody>
    </table>
    <table mat-table [dataSource]="dataSource" matSort matTableFilter
      matTableExporter class="mat-elevation-z8" #exporter="matTableExporter" [hiddenColumns]="[0,7]">
      <ng-container *ngFor="let col of columns;">
        <ng-container [matColumnDef]="col.name" *ngIf="col.name != 'select' && col.name != 'action'">
          <mat-header-cell *matHeaderCellDef mat-sort-header class="hided-arrow" arrowPosition="before">{{col.displayName }}
          </mat-header-cell>
          <mat-cell *matCellDef="let element"> {{ element[col.name] }} </mat-cell>
        </ng-container>
        <ng-container [matColumnDef]="col.name" *ngIf="col.name == 'select'">
          <mat-header-cell *matHeaderCellDef>
            <mat-checkbox (change)="$event ? masterToggle() : null" [checked]="selection.hasValue() && isAllSelected()"
              [indeterminate]="selection.hasValue() && !isAllSelected()">
            </mat-checkbox>
          </mat-header-cell>
          <mat-cell *matCellDef="let row">
            <mat-checkbox (click)="$event.stopPropagation()" (change)="$event ? selection.toggle(row) : null"
              [checked]="selection.isSelected(row)">
            </mat-checkbox>
          </mat-cell>
        </ng-container>

        <ng-container [matColumnDef]="col.name" *ngIf="col.name == 'action'">
          <mat-header-cell *matHeaderCellDef> {{ col.displayName }} </mat-header-cell>
          <mat-cell *matCellDef="let element">
            <button mat-icon-button (click)="openDialog('Update',element)">
              <mat-icon mat-icon-button color='primary'>edit</mat-icon>
            </button>
            <button mat-icon-button (click)="openDialog('Delete',element)">
              <mat-icon mat-icon-button color="warn">delete</mat-icon>
            </button>
          </mat-cell>
        </ng-container>
      </ng-container>
      <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row>
      <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
    </table>
    <!-- handling Empty table when filtering and list all scenarios-->

    <table>
      <tbody>
        <tr *ngIf="dataSource.data.length === 0">
          <td style="text-align: center;" [attr.colspan]="displayedColumns.length">
            <mat-card>No Records Found
            </mat-card>
          </td>
        </tr>
        <tr *ngIf="displayNoRecords">
          <td style="text-align: center;" [attr.colspan]="displayedColumns.length">
            <mat-card>
              <h3 style="text-align:center">No Records found for
                <span style="color:purple"><b>"{{dataSource.filter}}"</b></span>
              </h3>
            </mat-card>
          </td>
        </tr>
      </tbody>

    </table>

    <!-- Data table pagination-->

    <mat-paginator [hidden]="!dataSource.data.length" [pageSize]="5" class="mat-paginator-sticky"
      [pageSizeOptions]="[5, 10, 25,50,100]" showFirstLastButtons></mat-paginator>

  </div>
</div>